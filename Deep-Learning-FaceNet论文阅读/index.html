<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.4.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png?v=6.4.0">


  <link rel="mask-icon" href="/images/logo.png?v=6.4.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.4.0',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Abstract: In this paper we present a system, called FaceNet, that directly learns a mapping from face images to a compact Euclidean space where distances directly correspond to a measure of face simil">
<meta name="keywords" content="Face Recognition,FaceNet,GoogleNet">
<meta property="og:type" content="article">
<meta property="og:title" content="FaceNet论文阅读">
<meta property="og:url" content="http://www.face2ai.com/Deep-Learning-FaceNet论文阅读/index.html">
<meta property="og:site_name" content="谭升的博客">
<meta property="og:description" content="Abstract: In this paper we present a system, called FaceNet, that directly learns a mapping from face images to a compact Euclidean space where distances directly correspond to a measure of face simil">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://tony4ai-1251394096.cos.ap-hongkong.myqcloud.com/blog_images/Deep-Learning-FaceNet论文阅读/12.png">
<meta property="og:image" content="https://tony4ai-1251394096.cos.ap-hongkong.myqcloud.com/blog_images/Deep-Learning-FaceNet论文阅读/11.png">
<meta property="og:image" content="https://tony4ai-1251394096.cos.ap-hongkong.myqcloud.com/blog_images/Deep-Learning-FaceNet论文阅读/7.png">
<meta property="og:image" content="https://tony4ai-1251394096.cos.ap-hongkong.myqcloud.com/blog_images/Deep-Learning-FaceNet论文阅读/1.png">
<meta property="og:updated_time" content="2018-09-26T12:01:15.216Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FaceNet论文阅读">
<meta name="twitter:description" content="Abstract: In this paper we present a system, called FaceNet, that directly learns a mapping from face images to a compact Euclidean space where distances directly correspond to a measure of face simil">
<meta name="twitter:image" content="https://tony4ai-1251394096.cos.ap-hongkong.myqcloud.com/blog_images/Deep-Learning-FaceNet论文阅读/12.png">






  <link rel="canonical" href="http://www.face2ai.com/Deep-Learning-FaceNet论文阅读/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>FaceNet论文阅读 | 谭升的博客</title>
  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-105335860-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-105335860-3');
</script>






  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">谭升的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">人工智能基础</h1>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-首页">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-数学目录">
    <a href="/math/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />数学目录</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-算法目录">
    <a href="/ai-blog/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />算法目录</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-编程目录">
    <a href="/program-blog/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />编程目录</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-其他笔记">
    <a href="/other-note/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />其他笔记</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-本站论坛(施工中)">
    <a href="http:/bbs.face2ai.com" rel="section">
      <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />本站论坛(施工中)</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-阅读排行榜">
    <a href="/top/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-signal"></i> <br />阅读排行榜</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  


</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            



<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- footer -->
<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-1194454329688573"
data-ad-slot="2491973880"
data-ad-format="auto"
data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.face2ai.com/Deep-Learning-FaceNet论文阅读/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="谭升">
      <meta itemprop="description" content="强化学习 机器学习 人工智能">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="谭升的博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">FaceNet论文阅读
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-10-13 09:17:36" itemprop="dateCreated datePublished" datetime="2017-10-13T09:17:36+08:00">2017-10-13</time>
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Deep-Learning/" itemprop="url" rel="index"><span itemprop="name">Deep Learning</span></a></span>

                
                
              
            </span>

          

          
            
          

          
          
             <span id="/Deep-Learning-FaceNet论文阅读/" class="leancloud_visitors" data-flag-title="FaceNet论文阅读">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数：</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          


        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><strong>Abstract:</strong> In this paper we present a system, called FaceNet, that directly learns a mapping from face images to a compact Euclidean space where distances directly correspond to a measure of face similarity</p>
<p>提出一个系统，此系统能将人脸图片直接映射到欧几里得空间的一个向量，这些向量之间的距离能直接度量人脸之间的相似度</p>
<p><strong>Keywords:</strong> 人脸识别,FaceNet,GoogleNet</p>
<a id="more"></a>
<h1 id="FaceNet论文阅读"><a href="#FaceNet论文阅读" class="headerlink" title="FaceNet论文阅读"></a>FaceNet论文阅读</h1><p>从老的wordpress转移过来，之前一年一直在做人脸识别算法研究，现在回头看看too young too simple，但是这些经历也算对自己的有很多帮助，认清自己的水平，知道自己什么方面比较差，这样也算是有所帮助</p>
<blockquote>
<p>Our method uses a deep convolutional network trained to directly optimize the embedding itself, rather than an intermediate bottleneck layer as in previous deep learning approaches.</p>
</blockquote>
<p>深度卷积网络直接优化embedding，而不是以往深度学习的连接层</p>
<blockquote>
<p>To train, we use triplets of roughly aligned matching / non-matching face patches generated using a novel online triplet mining method</p>
</blockquote>
<p>在训练过程中，我们使用粗略对齐的匹配和非匹配人脸区块的triplets，这些triplets是通过一个出色的在线triplet挖掘方法得到的</p>
<blockquote>
<p>128-bytes per face</p>
</blockquote>
<p>每个人脸使用128维向量表征</p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><blockquote>
<p>The network is trained such that the squared L2 distances in the embedding space directly correspond to face similarity: faces of the same person have small distances and faces of distinct people have large distances.</p>
</blockquote>
<p>网络输出embedding ，在embedding空间直接描述人脸的相似程度，同一个人有较近的距离，不同的人有较远的距离</p>
<blockquote>
<p>Previous face recognition approaches based on deep networks use a classification layer [15, 17] trained over a set of known face identities and then take an intermediate bottleneck layer as a representation used to generalize recognition beyond the set of identities used in training</p>
</blockquote>
<p>之前人脸识别给予深度网络的使用一个分类器层，独立地使用一组已知的人脸来训练，然后使用一个中间瓶颈层作为一个人脸的表征，来用于识别不同于训练样本类别的人脸</p>
<blockquote>
<p>The downsides of this approach are its indirectness and its inefficiency: one has to hope that the bottleneck representation generalizes well to new faces; and by using a bottleneck layer the representation size per face is usually very large (1000s of dimensions)</p>
</blockquote>
<p>以前识别算法的劣势在于不直接和低效：其必须希望瓶颈层的表征对于新的人脸有好的范化能力；使用瓶颈层的表征的维数非常大，1000或更多。</p>
<blockquote>
<p>Some recent work [15] has reduced this dimensionality using PCA, but this is a linear transformation that can be easily learnt in one layer of the network</p>
</blockquote>
<p>一些最近的工作为了减少维数使用pca降维，但是其是一个线性变换，可以在任意一层网络层轻松学到。</p>
<blockquote>
<p>FaceNet directly trains its output to be a compact 128-D embedding using a triplet-based loss function based on LMNN [19].</p>
</blockquote>
<p>FaceNet直接训练他的输出使其达到紧凑的128维embedding，使用基于LMNN 【19】的triplet 损失函数</p>
<blockquote>
<p>Our triplets consist of two matching face thumbnails and a non-matching face thumbnail and the loss aims to separate the positive pair from the negative by a distance margin</p>
</blockquote>
<p>triplet包含两张匹配的人脸，和一张非匹配的人脸，目的是用一对正例，和一对负例，并保证ap和an之间差一个margin（空隙，空间）</p>
<blockquote>
<p>The thumbnails are tight crops of the face area, no 2D or 3D alignment, other than scale and translation is performed</p>
</blockquote>
<p>样本内容为人脸紧凑的切割，不需要任何2D，3D的对齐，尺度变换，和其他变换</p>
<blockquote>
<p>Choosing which triplets to use turns out to be very important for achieving good performance and,</p>
</blockquote>
<p>选择triplets很重要</p>
<blockquote>
<p>inspired by curriculum learning [1], we present a novel online negative exemplar mining strategy which ensures consistently increasing difficulty of triplets as the network trains.</p>
</blockquote>
<p>受到【1】的启发，我们提出了一个新奇的在线负样本挖掘策略，来确保在网络训练过程中持续增加triplets的难度</p>
<p>To improve clustering accuracy, we also explore hard-positive mining techniques which encourage spherical clusters for the embeddings of a single person.</p>
<blockquote>
</blockquote>
<blockquote>
<p>为了提高聚类正确性，使用hard正样本挖掘技术，来确保单个人脸的EMbedding约束在球形内</p>
</blockquote>
<p>可以处理以前觉得很难的样本，如下：</p>
<p><img src="https://tony4ai-1251394096.cos.ap-hongkong.myqcloud.com/blog_images/Deep-Learning-FaceNet论文阅读/12.png" alt=""></p>
<h2 id="RelatedWork"><a href="#RelatedWork" class="headerlink" title="RelatedWork"></a>RelatedWork</h2><blockquote>
<p>Similarly to other recent works which employ deep networks [15, 17], our approach is a purely data driven method which learns its representation directly from the pixels of the face. Rather than using engineered features, we use a large dataset of labelled faces to attain the appropriate invariances to pose, illumination, and other variational conditions.</p>
</blockquote>
<p>类似于15，17，我们的应用是纯粹的数据驱动的方法，使用人脸图片的像素作为输入，而不是使用人工构建的特征，使用大量的标记后的人脸数据使网络对于pose，illumination和其他conditions稳定。</p>
<p>本文讨论了两种网络架构：</p>
<blockquote>
<p>1:The first architecture is based on the Zeiler&amp;Fergus [22] model which consists of multiple inter-leaved layers of convolutions, non-linear activations, local response normalizations, and max pooling layers</p>
</blockquote>
<blockquote>
<p>2:The second architecture is based on the Inception model of Szegedy et al. which was recently used as the winning approach for ImageNet 2014 [16]</p>
</blockquote>
<blockquote>
<p>We have found that these models can reduce the number of parameters by up to 20 times and have the potential to reduce the number of FLOPS required for comparable performance</p>
</blockquote>
<p>以上两种网络结构能减少20倍以上的参数，并且能潜在的减少FLOPS的数量（与同类的网络）</p>
<p>近期人脸识别工作一大堆，挑几个代表性的说：</p>
<blockquote>
<p>The works of [15, 17, 23] all employ a complex system of multiple stages, that combines the output of a deep con-volutional network with PCA for dimensionality reduction and an SVM for classification：</p>
</blockquote>
<p>深度学习+PCA+SVM</p>
<blockquote>
<p>Zhenyao et al. [23] employ a deep network to “warp” faces into a canonical frontal view and then learn CNN that classifies each face as belonging to a known identity. For face verification, PCA on the network output in conjunction with an ensemble of SVMs is used.</p>
</blockquote>
<p>使用深度网络把脸弄成正面视角的，然后训练网络，verification的时候PCA网络输出，然后用svm分类</p>
<blockquote>
<p>Taigman et al. [17] propose a multi-stage approach that aligns faces to a general 3D shape model. Amulti-class network is trained to perform the face recognition task on over four thousand identities.</p>
</blockquote>
<p>多阶段应用来align人脸，得到3d的形状，然后训练多类网络来进行识别</p>
<blockquote>
<p>Sun et al. [14, 15] propose a compact and therefore relatively cheap to compute network. They use an ensemble of 25 of these network, each operating on a different face patch.</p>
</blockquote>
<p>小型紧凑的网络模型，易于计算，共使用25个这样的网络，每个网络对应于人脸的不同区块。</p>
<blockquote>
<p>The verification loss is similar to the triplet loss we employ [12, 19], in that it minimizes the L2-distance between faces of the same identity and enforces a margin between the distance of faces of different identities.</p>
</blockquote>
<p>Verification loss 类似于triplet loss 我们引用自12，19的方法，最小化L2距离，在同一个人之间和不同人之间的margin。</p>
<h2 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h2><p>two different core architectures:</p>
<ol>
<li>The Zeiler&amp;Fergus [22] style networks</li>
</ol>
<blockquote>
<p>the recent Inception [16] type networks</p>
</blockquote>
<p>Given the model details, and treating it as a black box (see Figure 2), the most important part of our approach lies in the end-to-end learning of the whole system.</p>
<p>网络模型当做黑盒如下图，我们主要关心更重要的。端对端的系统学习</p>
<p><img src="https://tony4ai-1251394096.cos.ap-hongkong.myqcloud.com/blog_images/Deep-Learning-FaceNet论文阅读/11.png" alt=""></p>
<p>To this end we employ the triplet loss that directly reflects what we want to achieve in face verification, recognition and clustering.</p>
<p>在一端，我们使用triplet loss 直接反应我们想要在人脸分辨，识别，聚类中达成的目标</p>
<p>Namely, we strive for an embedding f(x), from an image x into a feature space Rd,</p>
<p>我们使用embedding   ， f（x）直接将图像从x域映射到特征空间R（d维），</p>
<p>The triplet loss, however, tries to enforce a margin between each pair of faces from one person to all other faces. This allows the faces for one identity to live on a manifold, while still enforcing the distance and thus discriminability to other identities</p>
<p>Triplet loss 试图去注意在正样本对和负样本对之间的margin，这使得同一类的人脸存在于多种情况，同时也关注其间的距离，因此对于其他类可分辨。</p>
<h2 id="Triplet-Loss"><a href="#Triplet-Loss" class="headerlink" title="Triplet Loss"></a>Triplet Loss</h2><p>Here we want to ensure that an image<br>我们要确保对于一张图：</p>
<p>1.of a specific person is closer to all other images<br>同一人的不同图片距离$x_i^p(positive)$</p>
<p>2.of the same person than it is to any image<br>母样本，或者称为锚点$x_i^a(anchor)$</p>
<p>3.of any other person</p>
<p>对于其他样本（负样本）$x_i^n(negative)$</p>
<p>我们希望确保同一人的ap相近，ab距离远，如下图<br><img src="https://tony4ai-1251394096.cos.ap-hongkong.myqcloud.com/blog_images/Deep-Learning-FaceNet论文阅读/7.png" alt=""></p>
<p>因此，我们希望：</p>
<p>$$<br>||x_i^a-x_i^p||_2^2+\alpha &lt; ||x_i^a-x_i^n||_2^2 ,\forall(x_i^a,x_i^p,x_i^n)\in\tau<br>$$<br>alpha表示margin在正例对和负例对之间的距离，T是一组可能的triplets在训练数据集中的。基数为N。</p>
<p>最小化的Loss：</p>
<p>$$\sum_i^N[||f(x_i^a)-f(x_i^p)||^2_2-||f(x_i^a)-f(x_i^n)||^2_2+\alpha]_{+}$$</p>
<blockquote>
<p>Generating all possible triplets would result in many triplets that are easily satisfied (i.e. fulfill the constraint in Eq. (1)). These triplets would not contribute to the training and result in slower convergence, as they would still be passed through the network. It is crucial to select hard triplets, that are active and can therefore contribute to improving the model.</p>
</blockquote>
<p>计算所有可能的triplet容易导致其中很多对于网络是无用的（网络可以轻易使其满足公式1），这些triplet对于训练和结果收敛速度没有贡献，选择难以分类的是重要的，这些是有吸引力的，而且可以帮助提高模型</p>
<h2 id="Triplet-Selection"><a href="#Triplet-Selection" class="headerlink" title="Triplet Selection"></a>Triplet Selection</h2><p>In order to ensure fast convergence it is crucial to select triplets that violate the triplet constraint in Eq. (1)</p>
<p>为了快速收敛，选择违反公式1的triplet具有决定性作用。</p>
<p>选择hard-positive和hard-nagetive：</p>
<p>$$<br>argmax_{x_i^p}||f(x_i^a)-f(x_i^p)||^2_2<br>$$</p>
<p>$$<br>argmax_{x_i^p}||f(x_i^a)-f(x_i^n)||^2_2<br>$$</p>
<p>It is infeasible to compute the argmin and argmax across the whole training set.</p>
<p>在完整数据集上计算argmin和argmax是不可能的<br>Additionally, it might lead to poor training, as mislabelled and poorly imaged faces would dominate the hard positives and negatives. There are two obvious choices that avoid this issue:</p>
<p>尤其是，其可能导致不好的结果，因为有一些训练数据未准确标记，模糊的图片可能会决定hard positives或者hard negative，有两种明确的选择可以避免这两个问题：</p>
<blockquote>
<p>Generate triplets offline every n steps, using the most recent network checkpoint and computing the argmin and argmax on a subset of the data.</p>
</blockquote>
<p>每N步后线下寻找triplet，使用最近生成的网络，计算argmin和argmax在数据的一个子集上</p>
<blockquote>
<p>Generate triplets online. This can be done by selecting the hard positive/negative exemplars from within a mini-batch.</p>
</blockquote>
<p>在线获取triplet，通过从一个小的batch中选取hard positive或者hard negative样本。</p>
<blockquote>
<p>Here, we focus on the online generation and use large mini-batches in the order of a few thousand exemplars and only compute the argmin and argmax within a mini-batch.</p>
</blockquote>
<p>这里我们专注于在线获取，使用大的mini-batches包含几千个样本，而且只计算argmin和argmax在这个mini-batche上</p>
<blockquote>
<p>To have a meaningful representation of the anchor-positive distances, it needs to be ensured that a minimal number of exemplars of any one identity is present in each mini-batch. In our experiments we sample the training data such that around 40 faces are selected per identity per mini-batch. Additionally, randomly sampled negative faces are added to each mini-batch.</p>
</blockquote>
<p>为了获得一个有意义的AP距离的表达，其需要确保在每一个mini-batch任一类必须有少量的样本被选出，我们的经验是我们在训练样本中采样大约40个人脸图像每个人每个mini-batch。此外，随机采样负样本人脸，加入到每一个mini-batch</p>
<blockquote>
<p>Instead of picking the hardest positive, we use all anchor-positive pairs in a mini-batch while still selecting the hard negatives.</p>
</blockquote>
<p>我们选取mini-batch中所有的ap对而不是选择最难的ap对。但是我们依然选择最难的an对</p>
<blockquote>
<p>We don’t have a side-by-side comparison of hard anchor-positive pairs versus all anchor-positive pairs within a mini-batch, but we found in practice that the all anchor- positive method was more stable and converged slightly faster at the beginning of training.</p>
</blockquote>
<p>我们没有对mini-batch中的所有ap对进行side-by-side的hard程度比较，但是我们的经验是所有的ap对都使用能够增强收敛稳定性和速度，在训练初始阶段。</p>
<blockquote>
<p>We also explored the offline generation of triplets in conjunction with the online generation and it may allow the use of smaller batch sizes, but the experiments were inconclusive.</p>
</blockquote>
<p>offline和online结合，这种方法允许使用更小的batch大小，但是结果是没啥结果。。</p>
<blockquote>
<p>Selecting the hardest negatives can in practice lead to bad local minima early on in training, specifically it can result in a collapsed model (i.e. f(x) = 0). In order to mitigate this, it helps to select xni such that</p>
</blockquote>
<p>选择最难的AN对可以在训练早起引导向局部最小值，特别的，他能勾引起模型塌陷，为了避免这种情况，我们选取n的时候要满足以下条件：</p>
<p>$$||f(x_i^a)-f(x_i^p)||^2_2&lt;||f(x_i^a)-f(x_i^n)||^2_2$$</p>
<blockquote>
<p>We call these negative exemplars semi-hard, as they are further away from the anchor than the positive exemplar, but still hard because the squared distance is close to the anchor-positive distance. Those negatives lie inside the margin α.</p>
</blockquote>
<p>我们称这些negative为semi-hard，因为他们距离anchor比positive远，但是还难以区分，因为距离还是比较接近ap距离，这些negative在margin alpha内！</p>
<blockquote>
<p>As mentioned before, correct triplet selection is crucial for fast convergence.</p>
</blockquote>
<p>选好triplet能加速收敛</p>
<blockquote>
<p>On the one hand we would like to use small mini-batches as these tend to improve convergence during Stochastic Gradient Descent (SGD) [20].</p>
</blockquote>
<p>一方面我们使用小的mini-batch加速收敛，使用sgd</p>
<blockquote>
<p>On the other hand, implementation details make batches of tens to hundreds of exemplars more efficient.</p>
</blockquote>
<p>另一方面，执行细节使得样本的几十到几千的batch更有效</p>
<blockquote>
<p>The main constraint with regards to the batch size, however, is the way we select hard relevant triplets from within the mini-batches.</p>
</blockquote>
<p>Batch size 的主要的约束是我们从mini-batches选择hard triplet的方式</p>
<blockquote>
<p>In most experiments we use a batch size of around 1,800 exemplars</p>
</blockquote>
<p>Batch size大约1800个样例</p>
<h2 id="Deep-Convolutional-Networks"><a href="#Deep-Convolutional-Networks" class="headerlink" title="Deep Convolutional Networks"></a>Deep Convolutional Networks</h2><blockquote>
<p>In all our experiments we train the CNN using Stochastic Gradient Descent (SGD) with standard backprop [8, 11] and AdaGrad [5]. In most experiments we start with a learning rate of 0.05 which we lower to finalize the model. The models are initialized from random, similar to [16], and trained on a CPU cluster for 1,000 to 2,000 hours. The decrease in the loss (and increase in accuracy) slows down drastically after 500h of training, but additional training can still significantly improve performance. The margin α is set to 0.2.</p>
</blockquote>
<p>使用BP算法和SGD优化来训练CNN，AdaGrad用来调整步长，初始化步长为0.05，模型随机初始化，类似于16，使用cpu集群训练了1000-2000小时，500小时后训练效果变化变慢，但还是继续训练还是有效果的，alpha选择0.2</p>
<blockquote>
<p>The first category, shown in Table 1, adds 1×1×d convolutional layers, as suggested in [9], between the standard convolutional layers of the Zeiler&amp;Fergus [22] architecture and results in a model 22 layers deep. It has a total of 140 million parameters and requires around 1.6 billion FLOPS per image.<br>The second category we use is based on GoogLeNet style Inception models [16]. These models have 20× fewer parameters (around 6.6M-7.5M) and up to 5×fewer FLOPS(between 500M-1.6B).</p>
</blockquote>
<p><img src="https://tony4ai-1251394096.cos.ap-hongkong.myqcloud.com/blog_images/Deep-Learning-FaceNet论文阅读/1.png" alt=""></p>
<p>原文地址1：<a href="https://www.face2ai.com/Deep-Learning-FaceNet论文阅读">https://www.face2ai.com/Deep-Learning-FaceNet论文阅读</a>转载请标明出处</p>

      
    </div>









    
    
    



    
    
      

<div class="post-body">
<div class="note info">
  
  <rl class="recommended">相关文章</rl>
  <ul class="popular-posts">
  
    <li class="popular-posts-item">
      
      
      <div class="popular-posts-title"><a href="/Deep-Learning-Visualizing-and-Understanding-CNN/" rel="bookmark">Visualizing and Understanding CNN</a></div>
      
    </li>
  
    <li class="popular-posts-item">
      
      
      <div class="popular-posts-title"><a href="/Deep-Learning-LeNet/" rel="bookmark">LeNet论文解读</a></div>
      
    </li>
  
  </ul>
</div>
</div>


    


    <footer class="post-footer">
      

      
      
        <div class="post-widgets">
        
          <div class="wp_rating" >
          <div style="color: rgba(0, 0, 0, 1); font-size:16px; letter-spacing:3px">(&gt;壮士！看完给洒家个五星，你看行不行！&lt;)</div>
            <div id="wpac-rating"></div>
          </div>
        

        
        
        </div>
      
      

      

      
        <div>
          <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>关注公众号或添加博主微信，反馈问题，获取资讯（暗号:face2ai）</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>联系博主</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/weixin.png" alt="谭升 博主微信"/>
        <p>博主微信</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="谭升 博客公众号"/>
        <p>博客公众号</p>
      </div>
    

    

  </div>
</div>

        </div>
      



      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/Math-Linear-Algebra-Chapter-3-6/" rel="next" title="【线性代数】3-6:四个子空间的维度(Dimensions of the Four Subspaces)">
                <i class="fa fa-chevron-left"></i> 【线性代数】3-6:四个子空间的维度(Dimensions of the Four Subspaces)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/Math-Linear-Algebra-Chapter-4-1/" rel="prev" title="【线性代数】4-1:四个正交子空间(Orthogonality of the Four Subspace)">
                【线性代数】4-1:四个正交子空间(Orthogonality of the Four Subspace) <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- footer -->
  <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1194454329688573"
     data-ad-slot="2491973880"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>



          </div>
          

  
  


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.gif"
                alt="谭升" />
            
              <p class="site-author-name" itemprop="name">谭升</p>
              <p class="site-description motion-element" itemprop="description">强化学习 机器学习 人工智能</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives">
                
                    <span class="site-state-item-count">263</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">20</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/tony-tan" target="_blank" title="GitHub" rel="external nofollow"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:tony.face2ai@gmail.com" target="_blank" title="E-Mail" rel="external nofollow"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://twitter.com/Tony_Face2AI" target="_blank" title="Twitter" rel="external nofollow"><i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
              <div class="links-of-blogroll motion-element links-of-blogroll-block"  >
                <div class="links-of-blogroll-title" align="left">
                  <!-- modify icon to fire by szw -->
                  <i class="fa fa-history fa-" aria-hidden="true"></i>
                  近期文章
                </div>
                <ul class="links-of-blogroll-list" align="left">
                  
                  
                    <li>
                      <a href="/RL-RSAB-1-5-An-Extended-Example/" title="【强化学习】 1.5 强化学习的一个扩展举例" target="_blank">【强化学习】 1.5 强化学习的一个扩展举例</a>
                    </li>
                  
                    <li>
                      <a href="/RL-RSAB-1-4-1-Connection-to-Optimization-Method/" title="【强化学习】 1.4.1 强化学习与优化方法" target="_blank">【强化学习】 1.4.1 强化学习与优化方法</a>
                    </li>
                  
                    <li>
                      <a href="/Julia-Lang-0-Introduction/" title="【Julia】 Julia编程语言介绍" target="_blank">【Julia】 Julia编程语言介绍</a>
                    </li>
                  
                    <li>
                      <a href="/ITILA-Introduction-to-This-Series/" title="【信息论、推理与学习算法】本系列博客介绍" target="_blank">【信息论、推理与学习算法】本系列博客介绍</a>
                    </li>
                  
                    <li>
                      <a href="/RL-RSAB-1-4-0-Limitations-and-Scope/" title="【强化学习】 1.4.0 “进化方法”和 “决策梯度方法”  概论" target="_blank">【强化学习】 1.4.0 “进化方法”和 “决策梯度方法”  概论</a>
                    </li>
                  
                </ul>
          


          
            
          
          <div id="days"></div>
<script>
function show_date_time(){
window.setTimeout("show_date_time()", 1000);
BirthDay=new Date(" 11/27/2013 00:00:00");
today=new Date();
timeold=(today.getTime()-BirthDay.getTime());
sectimeold=timeold/1000
secondsold=Math.floor(sectimeold);
msPerDay=24*60*60*1000
e_daysold=timeold/msPerDay
daysold=Math.floor(e_daysold);
e_hrsold=(e_daysold-daysold)*24;
hrsold=setzero(Math.floor(e_hrsold));
e_minsold=(e_hrsold-hrsold)*60;
minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
seconds=setzero(Math.floor((e_minsold-minsold)*60));
document.getElementById('days').innerHTML="第一篇博客至今已创作"+daysold+"天"+hrsold+"小时"+minsold+"分"+seconds+"秒";
}
function setzero(i){
if (i<10)
{i="0" + i};
return i;
}
show_date_time();
</script>

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#FaceNet论文阅读"><span class="nav-number">1.</span> <span class="nav-text">FaceNet论文阅读</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Introduction"><span class="nav-number">1.1.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RelatedWork"><span class="nav-number">1.2.</span> <span class="nav-text">RelatedWork</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Method"><span class="nav-number">1.3.</span> <span class="nav-text">Method</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Triplet-Loss"><span class="nav-number">1.4.</span> <span class="nav-text">Triplet Loss</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Triplet-Selection"><span class="nav-number">1.5.</span> <span class="nav-text">Triplet Selection</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Deep-Convolutional-Networks"><span class="nav-number">1.6.</span> <span class="nav-text">Deep Convolutional Networks</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">谭升</span>

  

  
</div>


  










        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="总访客量">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="总访问量">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.4.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.4.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.4.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.4.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.0"></script>



  



  










  





  

  
  <script>
    
    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url }) })
        .done(function ({ results }) {
          if (results.length > 0) {
            var counter = results[0];
            
            Counter('put', `/classes/Counter/${counter.objectId}`, JSON.stringify({ time: { "__op":"Increment", "amount":1 } }))
            
            .done(function () {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(counter.time + 1);
            })
            
            .fail(function ({ responseJSON }) {
                console.log('Failed to save Visitor num, with error message: ' + responseJSON.error);
            })
          } else {
            
              Counter('post', '/classes/Counter', JSON.stringify({ title: title, url: url, time: 1}))
                .done(function () {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(1);
                })
                .fail(function () {
                  console.log('Failed to create');
                });
            
          }
        })
      .fail(function ({ responseJSON }) {
        console.log('LeanCloud Counter Error:' + responseJSON.code + " " + responseJSON.error);
      });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + "99mvzicXt5ABYCU385fe5J1B-gzGzoHsz")
        .done(function ({ api_server }) {
          var Counter = function (method, url, data) {
            return $.ajax({
              method: method,
              url: `https://${api_server}/1.1${url}`,
              headers: {
                'X-LC-Id': "99mvzicXt5ABYCU385fe5J1B-gzGzoHsz",
                'X-LC-Key': "JcquIPFohejA5x6cn1xIVomJ",
                'Content-Type': 'application/json',
              },
              data: data,
            });
          };
          
          addCount(Counter);
          
        })
    });
  </script>



  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  
  

  
    
      <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      },
      TeX: {equationNumbers: { autoNumber: "AMS" }}
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/javascript" src="//cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    
  


  
  
  <script type="text/javascript">
  wpac_init = window.wpac_init || [];
  wpac_init.push({widget: 'Rating', id: 14057,
    el: 'wpac-rating',
    color: 'fc6423'
  });
  (function() {
    if ('WIDGETPACK_LOADED' in window) return;
    WIDGETPACK_LOADED = true;
    var mc = document.createElement('script');
    mc.type = 'text/javascript';
    mc.async = true;
    mc.src = '//embed.widgetpack.com/widget.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
  })();
  </script>


  

  

  

  

  

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
  <script>
    $("body").backstretch("https://tony4ai-1251394096.cos.ap-hongkong.myqcloud.com/blog_images/background.jpg")
  </script>
</body>
</html>
